{% extends "base.html" %}
{% block main %}
<div style="max-width:1000px; margin:auto;">
    <h1 style="text-align:center; font-size:3.5rem; color:var(--dark); margin:40px 0;">
        {{ cluster.name }}
    </h1>

    {% if all_completed %}
        <div style="background:#d4edda; padding:40px; border-radius:20px; text-align:center; border:3px solid var(--green);">
            <h2 style="color:var(--green); font-size:2.5rem;">ТАБРИК! Кластер пурра супорида шуд</h2>
            <a href="{% url 'cluster_result' cluster.id %}" class="btn btn-green" style="margin:20px;">
                Дидани натиҷа
            </a>
            <a href="?retry=1" style="color:var(--red); font-weight:bold;">Аз нав супоридан</a>
        </div>
    {% endif %}

    <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(350px, 1fr)); gap:30px; margin-top:50px;">
        {% for subject in subjects %}
        <div class="card">
            <h3 style="font-size:1.8rem; color:var(--dark);">{{ subject.name }}</h3>
            {% if subject in completed_in_current %}
                <p style="color:var(--green); font-size:2rem; font-weight:bold;">Супорида шуд</p>
            {% else %}
                <a href="{% url 'start_test' cluster.id subject.id %}" class="btn btn-red">
                    Супоридан
                </a>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</div>
<div style="text-align:center; margin-top:50px; display:flex; justify-content:center; gap:30px; flex-wrap:wrap;">
        <a href="{% url 'attempts_history' cluster.id %}" 
           style="color:#3498db; font-size:1.1rem; text-decoration:underline;">
            История всех попыток
        </a>
        <a href="{% url 'clusters_list' %}" 
           style="color:#3498db; font-size:1.1rem; text-decoration:none;">
            ← Назад к направлениям
        </a>
    </div>
{% endblock %}